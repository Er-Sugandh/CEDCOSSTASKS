                             INSTALL MAGENTO2 ON APACHE

sudo apt install apache2
sudo apt update
sudo apt install software-properties-common
sudo add-apt-repository ppa:ondrej/php
sudo apt update
sudo apt install php8.1 php8.1-cli php8.1-common php8.1-curl php8.1-gd php8.1-intl php8.1-mbstring php8.1-mysql php8.1-opcache php8.1-readline php8.1-xml php8.1-xsl php8.1-zip php8.1-bz2 libapache2-mod-php8.1 php8.1-bcmath php8.1-soap php8.1-fpm -y
sudo nano /etc/php/8.1/apache2/php.ini

max_execution_time=18000
max_input_time=1800
memory_limit=4G

sudo a2enmod proxy_fcgi
sudo a2enconf php8.1-fpm
sudo systemctl reload apache2.service

cd /opt/
sudo wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.0-amd64.deb
sudo dpkg -i elasticsearch-7.7.0-amd64.deb
sudo systemctl start elasticsearch
curl -XGET 'http://localhost:9200'
sudo chmod -R 777 /usr/local/bin/
sudo curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer --version=2.1.6
sudo mkdir /var/www/magento2
cd /var/www/magento2/
sudo wget https://codeload.github.com/magento/magento2/zip/refs/tags/2.4.4
sudo apt install unzip
sudo unzip 2.4.4
sudo cp -R magento2-2.4.4/* /var/www/magento2/
sudo apt install mysql-server
sudo mysql -u root -p
select user,host,plugin from mysql.user;
alter user 'root'@'localhost' identified with mysql_native_password by 'password';
create database magentodb;
flush privileges;
exit;

cd /usr/share
sudo wget https://www.phpmyadmin.net/downloads/phpMyAdmin-latest-all-languages.zip -O phpmyadmin.zip

sudo unzip phpmyadmin.zip

sudo rm phpmyadmin.zip

sudo mv phpMyAdmin-*-all-languages phpmyadmin

sudo chmod -R 0755 phpmyadmin

sudo nano /etc/apache2/conf-available/phpmyadmin.conf

# phpMyAdmin Apache configuration

Alias /phpmyadmin /usr/share/phpmyadmin

<Directory /usr/share/phpmyadmin>
    Options SymLinksIfOwnerMatch
    DirectoryIndex index.php
</Directory>

# Disallow web access to directories that don't need it
<Directory /usr/share/phpmyadmin/templates>
    Require all denied
</Directory>
<Directory /usr/share/phpmyadmin/libraries>
    Require all denied
</Directory>
<Directory /usr/share/phpmyadmin/setup/lib>
    Require all denied
</Directory>


sudo a2enconf phpmyadmin

sudo systemctl reload apache2

sudo mkdir /usr/share/phpmyadmin/tmp/

sudo chown -R ubuntu:www-data /usr/share/phpmyadmin/tmp/




sudo apt update
cd /var/www/magento2/
sudo apt install composer
sudo composer install
composer --version

sudo bin/magento setup:install --base-url=http://ithelp.cf/ --db-host=localhost --db-name=magentodb --db-user=root --db-password=password --admin-firstname=admin --admin-lastname=admin --mailto:admin-email=admin@email.com --admin-user=magentoadmin --admin-password=password@1 --language=en_US --currency=USD --timezone=America/Chicago --use-rewrites=1




bin/magento setup:install \
--base-url=http://3.141.164.150 \
--db-host=localhost \
--db-name=magentodb \
--db-user=root \
--db-password=password \
--admin-firstname=admin \
--admin-lastname=admin \
--admin-email=sugandhlkumar@cedcommerce.com \
--admin-user=admin \
--admin-password=Magento2$ \
--language=en_US \
--currency=USD \
--timezone=America/Chicago \
--use-rewrites=1

sudo nano app/etc/env.php
now change the admin name in the file

sudo systemctl restart apache2
cd /etc/apache2/sites-available/
sudo nano magento2.conf

<VirtualHost *:80>
    ServerAdmin magento2@test.com
    ServerName 3.19.255.146
    DocumentRoot /var/www/html/magento2/pub
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
    <Directory /var/www/html/magento2>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride All
                Order allow,deny
                allow from all
</Directory>
</VirtualHost>

sudo r -rf /etc/apache2/sites-enabled/000-default.conf
sudo a2ensite magento2.conf
sudo a2dissite 000-default.conf
sudo systemctl reload  apache2.service
cd /var/www/magento2/
sudo find var generated vendor pub/static pub/media app/etc -type f -exec chmod g+w {} +
sudo find var generated vendor pub/static pub/media app/etc -type d -exec chmod g+ws {} +
sudo chown -R ubuntu:www-data .
sudo systemctl restart apache2.service 
sudo a2enmod rewrite
sudo a2enmod headers
sudo a2enmod deflate
sudo a2enmod expires
sudo systemctl reload apache2.service 
sudo apt update -y
sudo apt install libapache2-mod-security2
sudo systemctl restart apache2.service
sudo apt-cache show libapache2-mod-security2
sudo a2enmod security2
sudo systemctl reload apache2.service
sudo chmod -R 777 /var/www/html/magento2/{pub,var}
sudo chmod  -R 777 setup/
sudo systemctl reload apache2.service
sudo systemctl restart php8.1-fpm.service
sudo systemctl daemon-reload
sudo chmod u+x bin/magento
sudo systemctl reload apache2.service



---------------SampleData Magento2--------------------------


/var/www$ sudo git clone https://github.com/magento/magento2-sample-data.git
/var/www$ cd magento2
sudo php -f /var/www/html/magento2-sample-data/dev/tools/build-sample-data.php -- --ce-source=/var/www/html/magento2
sudo bin/magento setup:upgrade
sudo systemctl restart apache2.service
success fully run magento

